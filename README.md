# Cashback Optimization System

Система подбора оптимальных категорий кешбэка по банковским картам с учётом лимитов и приоритетов.

## Описание

Проект помогает выбрать лучшие категории кешбэка среди нескольких банков (Тинькофф, МТС, Дом.рф, ПСБ, Сбербанк, Альфа, ОТП, ВТБ). Алгоритм учитывает:

- **Лимит категорий на банк** (`total_cats`) — у каждого банка ограниченное число слотов
- **Приоритет категорий** — сначала важные (на все, продукты, аптеки, такси, фастфуд и т.д.)
- **Уникальные категории** — категории, которые есть только у одного банка
- **MTS с низким приоритетом** — бонусы МТС в баллах, а не деньгах, поэтому выбираются в последнюю очередь
- **Закреплённые выборы** — можно зафиксировать свои категории, которые не будут меняться алгоритмом

## Установка

Требования: Python 3.x.

```bash
pip install -r requirements.txt
```

## Запуск

```bash
python CASHBACK_app.py
```

Или через батник (Windows):

```bash
run_cashback.bat
```

Для использования Anaconda Python:

```bash
C:\Users\denis\Software\anaconda\python.exe CASHBACK_app.py
```

## Результат

Скрипт создаёт два файла:

- **best_categories.txt** — полная таблица выбранных категорий
- **best_categories_active.txt** — только активные категории

Колонки: `rank`, `bank`, `category`, `ratio` (%), `m_limit` (лимит в руб.), `limit_type`, `status`, `locked` (1 = закреплено вами, 0 = выбрано алгоритмом).

## Настройка

### Банки и категории

Данные по банкам задаются в `CASHBACK_app.py` в виде кортежей:

```python
(bank, category, ratio, m_limit, limit_type, status, total_cats, bonus)
```

- `status=1` — категория участвует в выборе, `status=0` — отключена
- `total_cats` — максимум категорий на банк в месяц

### Приоритет категорий

Список `PRIORITY_CATEGORIES` задаёт порядок выбора: сначала «на все», продукты, аптеки, такси и каршеринг, жд билеты, фастфуд, кафе и рестораны, досуг, затем остальные.

### Закреплённые выборы

В `LOCKED_SELECTIONS` можно указать пары (банк, категория), которые вы уже выбрали и не хотите менять:

```python
LOCKED_SELECTIONS = [
    ('tbank', 'на все'),
    ('alpha', 'аптеки'),
]
```

## Алгоритм выбора

1. **Фаза 0** — добавляются все закреплённые (bank, category)
2. **Фаза 1** — для каждой приоритетной категории выбирается лучший банк по ratio (MTS в конце)
3. **Фаза 2** — заполняются слоты уникальными категориями (только у одного банка)
4. **Фаза 3** — оставшиеся слоты заполняются категориями с лучшим ratio

## Структура проекта

```
cashback project/
├── CASHBACK_app.py          # основной скрипт
├── run_cashback.bat         # запуск на Windows
├── requirements.txt         # зависимости (pandas, numpy)
├── LICENSE                  # MIT License
├── best_categories.txt      # результат (генерируется)
├── best_categories_active.txt
└── README.md
```

## Лицензия

MIT License — см. файл [LICENSE](LICENSE).
